var gameLogic;!function(a){function b(a,b){return angular.equals(a,b)}function c(a){return angular.copy(a)}function d(a,b,c){for(var d=new Array(8),e=0;8>e;e++)d[e]=new Array(!1,!1,!1,!1,!1,!1,!1,!1);var f=c[a][b];d[a][b]=!0;var g=1,h=new Array;for(h.push([a,b]);0!==h.length;){var i=h.pop(),j=i[0],k=i[1];8>j+1&&8>k+1&&d[j+1][k+1]===!1&&c[j+1][k+1]===f&&(h.push([j+1,k+1]),g++,d[j+1][k+1]=!0),j-1>=0&&k-1>=0&&d[j-1][k-1]===!1&&c[j-1][k-1]===f&&(h.push([j-1,k-1]),g++,d[j-1][k-1]=!0),8>j+1&&k-1>=0&&d[j+1][k-1]===!1&&c[j+1][k-1]===f&&(h.push([j+1,k-1]),g++,d[j+1][k-1]=!0),j-1>=0&&8>k+1&&d[j-1][k+1]===!1&&c[j-1][k+1]===f&&(h.push([j-1,k+1]),g++,d[j-1][k+1]=!0),8>j+1&&d[j+1][k]===!1&&c[j+1][k]===f&&(h.push([j+1,k]),g++,d[j+1][k]=!0),j-1>=0&&d[j-1][k]===!1&&c[j-1][k]===f&&(h.push([j-1,k]),g++,d[j-1][k]=!0),8>k+1&&d[j][k+1]===!1&&c[j][k+1]===f&&(h.push([j,k+1]),g++,d[j][k+1]=!0),k-1>=0&&d[j][k-1]===!1&&c[j][k-1]===f&&(h.push([j,k-1]),g++,d[j][k-1]=!0)}return 12===g?!0:!1}function e(a){for(var b=-1,c=-1,e=-1,f=-1,g=0;8>g;g++)for(var h=0;8>h&&!(b>=0&&c>=0&&e>=0&&f>=0);h++)"W"===a[g][h]?(b=g,c=h):"R"===a[g][h]&&(e=g,f=h);return d(b,c,a)?"W":d(e,f,a)?"R":""}function f(a,b,c){return 0==c?[a,0]:2==c?[0,b]:1==c?a>=b?[a-b,0]:[0,b-a]:-1==c?a+b>=7?[7,a+b-7]:[a+b,0]:void 0}function g(a,b){var c,d,e,g,h,l=[],m=0===b?"W":"R";for(c=0;8>c;c++)for(d=0;8>d;d++)a[c][d]===m&&(e=f(c,d,1),g=j(a,e[0],e[1],1),k(a,c,d,c+g,d+g,b)&&(h=i(a,c,d,c+g,d+g,b),l.push(h)),k(a,c,d,c-g,d-g,b)&&(h=i(a,c,d,c-g,d-g,b),l.push(h)),e=f(c,d,-1),g=j(a,e[0],e[1],-1),k(a,c,d,c+g,d-g,b)&&(h=i(a,c,d,c+g,d-g,b),l.push(h)),k(a,c,d,c-g,d+g,b)&&(h=i(a,c,d,c-g,d+g,b),l.push(h)),e=f(c,d,0),g=j(a,e[0],e[1],0),k(a,c,d,c,d-g,b)&&(h=i(a,c,d,c,d-g,b),l.push(h)),k(a,c,d,c,d+g,b)&&(h=i(a,c,d,c,d+g,b),l.push(h)),e=f(c,d,2),g=j(a,e[0],e[1],2),k(a,c,d,c-g,d,b)&&(h=i(a,c,d,c-g,d,b),l.push(h)),k(a,c,d,c+g,d,b)&&(h=i(a,c,d,c+g,d,b),l.push(h)));var n=l[Math.floor(Math.random()*l.length)];return n}function h(a,b,c,d){var e=[],g=f(b,c,1),h=j(a,g[0],g[1],1);return k(a,b,c,b+h,c+h,d)&&e.push([b+h,c+h]),k(a,b,c,b-h,c-h,d)&&e.push([b-h,c-h]),g=f(b,c,-1),h=j(a,g[0],g[1],-1),k(a,b,c,b-h,c+h,d)&&e.push([b-h,c+h]),k(a,b,c,b+h,c-h,d)&&e.push([b+h,c-h]),g=f(b,c,0),h=j(a,g[0],g[1],0),k(a,b,c,b,c+h,d)&&e.push([b,c+h]),k(a,b,c,b,c-h,d)&&e.push([b,c-h]),g=f(b,c,2),h=j(a,g[0],g[1],2),k(a,b,c,b+h,c,d)&&e.push([b+h,c]),k(a,b,c,b-h,c,d)&&e.push([b-h,c]),e}function i(a,b,c,d,f,g){var h=angular.copy(a);h[d][f]=0===g?"W":"R",h[b][c]="",console.log("create move apo to game logic");var i,j=e(h);return i=""!==j?{endMatch:{endMatchScores:"W"===j?[1,0]:[0,1]}}:{setTurn:{turnIndex:1-g}},console.log("create move apo to game logic"),[i,{set:{key:"board",value:h}},{set:{key:"delta",value:{brow:b,bcol:c,arow:d,acol:f}}}]}function j(a,b,c,d){var e=0;if(0===d)for(var f=0;8>f;f++)""!==a[b][c+f]&&e++;else if(2===d)for(var f=0;8>f;f++)""!==a[b+f][c]&&e++;else if(1===d)for(;8!==b&&8!==c;)""!==a[b][c]&&e++,b++,c++;else for(;-1!==b&&8!==c;)""!==a[b][c]&&e++,b--,c++;return e}function k(a,b,c,d,e,f){if(d>7||0>d||e>7||0>e)return!1;if(""!==a[d][e])return!1;var g=0===f?"R":"W";if(a[b][c]===g)return!1;if(Math.abs(b-d)!==Math.abs(c-e)&&b!==d&&c!==e)return!1;var h,i,k,l;b-d===0?(h=Math.abs(c-e),i=b,k=0,l=0):c-e===0?(h=Math.abs(b-d),i=0,k=c,l=2):(h=Math.abs(b-d),l=(b-d)/(c-e),l>0?b>=c?(i=b-c,k=0):(i=0,k=c-b):b+c>=7?(i=7,k=b+c-7):(i=b+c,k=0));var m=j(a,i,k,l);if(h!==m)return!1;for(var n=(d-b)/h,o=(e-c)/h,p=b,q=c;p!==d||q!==e;)if(p+=n,q+=o,a[p][q]===g)return!1;return!0}function l(a,b,c){for(var d=[],e=b,f=a,g=0;g<c.length;g++){var h=c[g];void 0==e.board&&(e.board=[["","R","R","R","R","R","R",""],["W","","","","","","","W"],["W","","","","","","","W"],["W","","","","","","","W"],["W","","","","","","","W"],["W","","","","","","","W"],["W","","","","","","","W"],["","R","R","R","R","R","R",""]]);var j=i(e.board,h.brow,h.bcol,h.arow,h.acol,f),k={board:j[1].set.value,delta:j[2].set.value};d.push({stateBeforeMove:e,stateAfterMove:k,turnIndexBeforeMove:f,turnIndexAfterMove:1-f,move:j,comment:{en:h.comment}}),e=k,f=1-f}return d}function m(){return[["","R","R","R","R","R","R",""],["W","","","","","","","W"],["W","","","","","","","W"],["W","","","","","","","W"],["W","","","","","","","W"],["W","","","","","","","W"],["W","","","","","","","W"],["","R","R","R","R","R","R",""]]}function n(){return[l(1,{board:[["W","","","","R","","",""],["W","W","W","","","","",""],["W","R","W","R","","","",""],["W","","R","","","","","R"],["W","","","R","","W","",""],["W","","W","","","","",""],["","","W","R","","","",""],["","R","R","R","R","R","",""]],delta:{brow:0,bcol:0,arow:0,acol:0}},[{brow:0,bcol:4,arow:2,acol:4,comment:"find the position for red where he could win the game"},{brow:4,bcol:5,arow:2,acol:5,comment:"white moves (4,5) to (2,5)"},{brow:7,bcol:5,arow:5,acol:3,comment:"red moves (7,5) to (5,3)"},{brow:2,bcol:5,arow:1,acol:4,comment:"white moves (2,5) to (1,4)"},{brow:3,bcol:7,arow:3,acol:4,comment:"red moves (3,7) to (3,4), red wins"}])]}function o(){return l(0,{},[{brow:1,bcol:0,arow:1,acol:2,comment:"The classic opening: white moves (1,0) to (1,2)"},{brow:0,bcol:3,arow:2,acol:3,comment:"red moves (0,2) to (2,3)"},{brow:1,bcol:2,arow:4,acol:2,comment:"white moves (1,2) to (4,2)"},{brow:0,bcol:1,arow:3,acol:4,comment:"red moves (0,1) to (3,4)"},{brow:6,bcol:0,arow:6,acol:2,comment:"white moves (6,0) to (6,2)"},{brow:0,bcol:5,arow:3,acol:2,comment:"red moves (0,5) to (3,2)"},{brow:5,bcol:0,arow:5,acol:2,comment:"white moves (5,0) to (5,2)"},{brow:0,bcol:2,arow:2,acol:4,comment:"red moves (0,2) to (2,4)"},{brow:6,bcol:7,arow:6,acol:5,comment:"white moves (6,7) to (6,5)"},{brow:0,bcol:4,arow:2,acol:6,comment:"red moves (0,4) to (2,6)"},{brow:5,bcol:7,arow:0,acol:7,comment:"white moves (5,7) to (0,7)"},{brow:0,bcol:6,arow:3,acol:6,comment:"red moves (0,6) to (3,6)"},{brow:0,bcol:7,arow:0,acol:6,comment:"white moves (0,7) to (0,6)"},{brow:3,bcol:6,arow:6,acol:3,comment:"red moves (3,6) to (6,3)"},{brow:6,bcol:5,arow:4,acol:5,comment:"white moves (6,5) to (4,5)"},{brow:2,bcol:6,arow:2,acol:1,comment:"red moves (2,6) to (2,1)"},{brow:4,bcol:7,arow:3,acol:6,comment:"white moves (4,7) to (3,6)"},{brow:7,bcol:6,arow:4,acol:3,comment:"red moves (7,6) to (4,3)"},{brow:2,bcol:0,arow:5,acol:0,comment:"white moves (2,0) to (5,0)"},{brow:7,bcol:5,arow:5,acol:3,comment:"red moves (7,5) to (5,3), red wins!"}])}function p(a){console.log("mpika sto ismoveok");var c=a.move,d=a.turnIndexBeforeMove,e=a.stateBeforeMove;try{var f=c[2].set.value.brow,g=c[2].set.value.bcol,h=c[2].set.value.arow,j=c[2].set.value.acol,l=e.board;if(void 0===l&&(l=[["","R","R","R","R","R","R",""],["W","","","","","","","W"],["W","","","","","","","W"],["W","","","","","","","W"],["W","","","","","","","W"],["W","","","","","","","W"],["W","","","","","","","W"],["","R","R","R","R","R","R",""]]),!k(l,f,g,h,j,d))return!1;var m=i(l,f,g,h,j,d);if(!b(c,m))return!1}catch(n){return!1}return!0}a.isEqual=b,a.copyObject=c,a.isWinner=d,a.getWinner=e,a.getStartRC=f,a.createComputerMove=g,a.getPossibleMoves=h,a.createMove=i,a.getCheckNum=j,a.isMoveLegal=k,a.getExampleMoves=l,a.getInitialBoard=m,a.getRiddles=n,a.getExampleGame=o,a.isMoveOk=p}(gameLogic||(gameLogic={})),angular.module("myApp",["ngTouch","ui.bootstrap","gameServices"]).factory("gameLogic",function(){gameLogic.getPossibleMoves,gameLogic.createComputerMove,gameLogic.createMove,gameLogic.getInitialBoard,gameLogic.isMoveOk,gameLogic.getExampleGame,gameLogic.getRiddles});var game;!function(a){function b(){resizeGameAreaService.setWidthToHeight(1),gameService.setGame({gameDeveloperEmail:"sm5119@nyu.edu",minNumberOfPlayers:2,maxNumberOfPlayers:2,exampleGame:gameLogic.getExampleGame(),riddles:gameLogic.getRiddles(),isMoveOk:gameLogic.isMoveOk,updateUI:m}),dragAndDropService.addDragListener("gameArea",d)}function c(){a.style=[[{},{},{},{},{},{},{},{}],[{},{},{},{},{},{},{},{}],[{},{},{},{},{},{},{},{}],[{},{},{},{},{},{},{},{}],[{},{},{},{},{},{},{},{}],[{},{},{},{},{},{},{},{}],[{},{},{},{},{},{},{},{}],[{},{},{},{},{},{},{},{}]];var b=gameLogic.createComputerMove(a.board,a.turnIndex),c=b[2].set.value.brow,d=b[2].set.value.bcol,e=b[2].set.value.arow,f=b[2].set.value.acol;a.style[c][d]=o(c,d,e,f),$timeout(function(){gameService.makeMove(b)},500)}function d(b,c,d){a.gameArea=document.getElementById("gameArea"),a.draggingLines=document.getElementById("draggingLines"),a.horizontalDraggingLine=document.getElementById("horizontalDraggingLine"),a.verticalDraggingLine=document.getElementById("verticalDraggingLine");var j,k,l=c-a.gameArea.offsetLeft,m=d-a.gameArea.offsetTop;if(0>l||0>m||l>=a.gameArea.clientWidth||m>=a.gameArea.clientHeight){if(a.draggingLines.style.display="none",!a.draggingPiece)return;{f()}}else{var k=Math.floor(a.colsNum*l/a.gameArea.clientWidth),j=Math.floor(a.rowsNum*m/a.gameArea.clientHeight);if("touchstart"!==b||a.draggingStartedRowCol||a.board[j][k]&&(a.onStartCallback(j,k),a.draggingStartedRowCol={row:j,col:k},a.isRed(j,k)&&(a.draggingPiece=document.getElementById("RedPiece"+a.draggingStartedRowCol.row+"x"+a.draggingStartedRowCol.col)),a.isWhite(j,k)&&(a.draggingPiece=document.getElementById("WhitePiece"+a.draggingStartedRowCol.row+"x"+a.draggingStartedRowCol.col)),a.draggingPiece.style["z-index"]=++a.nextZIndex,console.log("dragging piece=",a.draggingPiece)),!a.draggingPiece)return;if("touchend"===b){var n=a.draggingStartedRowCol,o={row:j,col:k};i(n,o)}else{e(g(j,k)),a.draggingLines.style.display="inline";var p=h(j,k);a.verticalDraggingLine.setAttribute("x1",""+p.x),a.verticalDraggingLine.setAttribute("x2",""+p.x),a.horizontalDraggingLine.setAttribute("y1",""+p.y),a.horizontalDraggingLine.setAttribute("y2",""+p.y)}}("touchend"===b||"touchcancel"===b||"touchleave"===b)&&(e(g(a.draggingStartedRowCol.row,a.draggingStartedRowCol.col)),a.draggingLines.style.display="none",a.draggingStartedRowCol=null,a.draggingPiece=null)}function e(b){var c=g(a.draggingStartedRowCol.row,a.draggingStartedRowCol.col);a.draggingPiece.style.left=b.left-c.left+"px",a.draggingPiece.style.top=b.top-c.top+"px"}function f(){return{width:a.gameArea.clientWidth/a.colsNum,height:a.gameArea.clientHeight/a.rowsNum}}function g(a,b){var c=f();return{top:a*c.height,left:b*c.width}}function h(a,b){var c=f();return{x:b*c.width+c.width/2,y:a*c.height+c.height/2}}function i(b,c){console.log("mpika sto dragdone");"Dragged piece "+b.row+"x"+b.col+" to square "+c.row+"x"+c.col;console.log("brow kai bcol apo dragdone "+a.brow+" "+a.bcol),n(c.row,c.col)}function j(a,b){return(a+b)%2==0}function k(a){for(var b=[],c=0;a>c;c++)b.push(c);return b}function l(){for(var b=[],c=0;c<a.rowsNum;c++){b[c]=[];for(var d=0;d<a.colsNum;d++)b[c][d]=0!=c&&13!=c||j(c,d)?null:"O"}return b}function m(b){a.board=b.stateAfterMove.board,a.delta=b.stateAfterMove.delta,void 0===a.board&&(a.board=gameLogic.getInitialBoard(),a.style=[[{},{},{},{},{},{},{},{}],[{},{},{},{},{},{},{},{}],[{},{},{},{},{},{},{},{}],[{},{},{},{},{},{},{},{}],[{},{},{},{},{},{},{},{}],[{},{},{},{},{},{},{},{}],[{},{},{},{},{},{},{},{}],[{},{},{},{},{},{},{},{}]]),a.isYourTurn=b.turnIndexAfterMove>=0&&b.yourPlayerIndex===b.turnIndexAfterMove,a.turnIndex=b.turnIndexAfterMove,a.isYourTurn&&""===b.playersInfo[b.yourPlayerIndex].playerId&&$timeout(c,750)}function n(b,c){console.log("mpika sto dropcallback"),a.isDragging=!0;try{console.log("mpika sto try"),console.log("brow kai bcol "+a.brow+" "+a.bcol),console.log("row kai col "+b+" "+c);var d=gameLogic.createMove(a.board,a.brow,a.bcol,b,c,a.turnIndex),e=gameLogic.isMoveOk({turnIndexBeforeMove:a.turnIndex,stateBeforeMove:{board:a.board,delta:{brow:a.brow,bcol:a.bcol,arow:b,acol:c}},move:d});if(console.log("i kinisi einai entaksei "+e),!e)return;if(a.isYourTurn=!1,a.isDragging===!1){a.style=[[{},{},{},{},{},{},{},{}],[{},{},{},{},{},{},{},{}],[{},{},{},{},{},{},{},{}],[{},{},{},{},{},{},{},{}],[{},{},{},{},{},{},{},{}],[{},{},{},{},{},{},{},{}],[{},{},{},{},{},{},{},{}],[{},{},{},{},{},{},{},{}]];{d[2].set.value.brow,d[2].set.value.bcol,d[2].set.value.arow,d[2].set.value.acol}$timeout(function(){gameService.makeMove(d)},500)}else gameService.makeMove(d);a.isDragging=!1}catch(f){return}}function o(a,b,c,d){var e=100*(d-b)+"px",f=100*(c-a)+"px";return{top:f,left:e,position:"relative","-webkit-animation":"moveAnimation 0.5s",animation:"moveAnimation 0.5s"}}a.rowsNum=8,a.colsNum=8,a.draggingStartedRowCol=null,a.draggingPiece=null,a.draggingPieceAvailableMoves=null,a.nextZIndex=61,a.board=void 0,a.init=b,a.sendComputerMove=c,a.handleDragEvent=d,a.setDraggingPieceTopLeft=e,a.getSquareWidthHeight=f,a.getSquareTopLeft=g,a.getSquareCenterXY=h,a.dragDone=i,a.isWhiteSquare=j,a.getIntegersTill=k,a.getInitialBoard=l,a.updateUI=m,m({stateAfterMove:{},turnIndexAfterMove:0,yourPlayerIndex:-2}),a.onStartCallback=function(b,c){a.brow=b,a.bcol=c,console.log("onstartcallback called")},a.onDropCallback=n,a.isEven=function(a,b){var c=a+b;return c%2===0},a.isOdd=function(a,b){var c=a+b;return c%2===1},a.isSelected=function(b,c){return a.brow===b&&a.bcol===c},a.isRed=function(b,c){return"R"===a.board[b][c]},a.isWhite=function(b,c){return"W"===a.board[b][c]},a.getStyle=o,a.shouldSlowlyAppear=function(b,c){return void 0!==a.delta&&a.delta.row===b&&a.delta.col===c}}(game||(game={})),angular.module("myApp").run(function(){$rootScope.game=game,translate.setLanguage("en",{RULES_OF_LINESOFACTIONS:"Rules of Lines of Actions",RULES_SLIDE1:"Lines of Action is played on a standard chessboard, with the same algebraic notation for ranks and files. Each player controls twelve checkers, which are initially arrayed as follows:",RULES_SLIDE2:"A checker moves exactly as many spaces as there are checkers (both friendly and enemy) on the line in which it is moving",RULES_SLIDE3:"A checker may jump over friendly checkers",RULES_SLIDE4:"A checker may not jump over an enemy checker",RULES_SLIDE5:"The object of the game is to bring all of one's checkers together into a contiguous body so that they are connected vertically, horizontally or diagonally",RULES_SLIDE6:"A player who is reduced to a single checker wins the game, because his pieces are by definition united.",CLOSE:"Close"}),game.init()});
//# sourceMappingURL=everything.min.js.map