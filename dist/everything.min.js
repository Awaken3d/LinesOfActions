angular.module("myApp",["ngTouch","ui.bootstrap"]).controller("Ctrl",["$window","$rootScope","$scope","$log","$timeout","gameService","gameLogic","resizeGameAreaService","dragAndDropService",function(a,b,c,d,e,f,g,h,i){"use strict";function j(){c.style=[[{},{},{},{},{},{},{},{}],[{},{},{},{},{},{},{},{}],[{},{},{},{},{},{},{},{}],[{},{},{},{},{},{},{},{}],[{},{},{},{},{},{},{},{}],[{},{},{},{},{},{},{},{}],[{},{},{},{},{},{},{},{}],[{},{},{},{},{},{},{},{}]];var a=g.createComputerMove(c.board,c.turnIndex),b=a[2].set.value.brow,d=a[2].set.value.bcol,h=a[2].set.value.arow,i=a[2].set.value.acol;c.style[b][d]=r(b,d,h,i),e(function(){f.makeMove(a)},500)}function k(a,b,d){var e,f,g=b-s.offsetLeft,h=d-s.offsetTop;if(0>g||0>h||g>=s.clientWidth||h>=s.clientHeight){if(draggingLines.style.display="none",!w)return;var i=m();l({top:h-i.height/2,left:g-i.width/2})}else{var f=Math.floor(u*g/s.clientWidth),e=Math.floor(t*h/s.clientHeight);if("touchstart"!==a||v||c.board[e][f]&&(c.onStartCallback(e,f),v={row:e,col:f},w=document.getElementById("MyPiece"+v.row+"x"+v.col),w.style["z-index"]=++x),!w)return;if("touchend"===a){var j=v,k={row:e,col:f};p(j,k)}else{l(n(e,f)),draggingLines.style.display="inline";var q=o(e,f);verticalDraggingLine.setAttribute("x1",q.x),verticalDraggingLine.setAttribute("x2",q.x),horizontalDraggingLine.setAttribute("y1",q.y),horizontalDraggingLine.setAttribute("y2",q.y)}}("touchend"===a||"touchcancel"===a||"touchleave"===a)&&(l(n(v.row,v.col)),draggingLines.style.display="none",v=null,w=null)}function l(a){var b=n(v.row,v.col);w.style.left=a.left-b.left+"px",w.style.top=a.top-b.top+"px"}function m(){return{width:s.clientWidth/u,height:s.clientHeight/t}}function n(a,b){var c=m();return{top:a*c.height,left:b*c.width}}function o(a,b){var c=m();return{x:b*c.width+c.width/2,y:a*c.height+c.height/2}}function p(a,e){b.$apply(function(){var b="Dragged piece "+a.row+"x"+a.col+" to square "+e.row+"x"+e.col;d.info(b),c.msg=b,c.onDropCallback(e.row,e.col)})}function q(a){c.board=a.stateAfterMove.board,c.delta=a.stateAfterMove.delta,void 0===c.board&&(c.board=g.getInitialBoard(),c.style=[[{},{},{},{},{},{},{},{}],[{},{},{},{},{},{},{},{}],[{},{},{},{},{},{},{},{}],[{},{},{},{},{},{},{},{}],[{},{},{},{},{},{},{},{}],[{},{},{},{},{},{},{},{}],[{},{},{},{},{},{},{},{}],[{},{},{},{},{},{},{},{}]]),c.isYourTurn=a.turnIndexAfterMove>=0&&a.yourPlayerIndex===a.turnIndexAfterMove,c.turnIndex=a.turnIndexAfterMove,c.isYourTurn&&""===a.playersInfo[a.yourPlayerIndex].playerId&&e(j,750)}function r(a,b,c,d){var e=100*(d-b)+"px",f=100*(c-a)+"px";return{top:f,left:e,position:"relative","-webkit-animation":"moveAnimation 0.5s",animation:"moveAnimation 0.5s"}}h.setWidthToHeight(1);var s=document.getElementById("gameArea"),t=8,u=8,v=null,w=null,x=61;i.addDragListener("gameArea",k),q({stateAfterMove:{},turnIndexAfterMove:0,yourPlayerIndex:-2}),c.onStartCallback=function(a,b){d.info("drag start on cell: ",a,b),c.brow=a,c.bcol=b},c.onDropCallback=function(a,b){d.info("drop on cell: ",a,b),d.info("brow, bcol: ",c.brow,c.bcol),c.isDragging=!0;try{var h=g.createMove(c.board,c.brow,c.bcol,a,b,c.turnIndex),i=g.isMoveOk({turnIndexBeforeMove:c.turnIndex,stateBeforeMove:{board:c.board,delta:{brow:c.brow,bcol:c.bcol,arow:a,acol:b}},move:h});if(!i)return;if(c.isYourTurn=!1,c.isDragging===!1){c.style=[[{},{},{},{},{},{},{},{}],[{},{},{},{},{},{},{},{}],[{},{},{},{},{},{},{},{}],[{},{},{},{},{},{},{},{}],[{},{},{},{},{},{},{},{}],[{},{},{},{},{},{},{},{}],[{},{},{},{},{},{},{},{}],[{},{},{},{},{},{},{},{}]];{h[2].set.value.brow,h[2].set.value.bcol,h[2].set.value.arow,h[2].set.value.acol}e(function(){f.makeMove(h)},500)}else f.makeMove(h);c.isDragging=!1}catch(j){return void d.info(["Cell is already full in position:",a,b])}},c.isEven=function(a,b){var c=a+b;return c%2===0},c.isOdd=function(a,b){var c=a+b;return c%2===1},c.isSelected=function(a,b){return c.brow===a&&c.bcol===b},c.isRed=function(a,b){return"R"===$board[a][b]},c.isWhite=function(a,b){return"W"===$board[a][b]},c.shouldSlowlyAppear=function(a,b){return void 0!==c.delta&&c.delta.row===a&&c.delta.col===b},f.setGame({gameDeveloperEmail:"sm5119@nyu.edu",minNumberOfPlayers:2,maxNumberOfPlayers:2,exampleGame:g.getExampleGame(),riddles:g.getRiddles(),isMoveOk:g.isMoveOk,updateUI:q})}]),angular.module("myApp").service("gameLogic",function(){function a(a,b){return angular.equals(a,b)}function b(a){return angular.copy(a)}function c(a,b,c){for(var d=new Array(8),e=0;8>e;e++)d[e]=new Array(!1,!1,!1,!1,!1,!1,!1,!1);var f=c[a][b];d[a][b]=!0;var g=1,h=new Array;for(h.push([a,b]);0!==h.length;){var i=h.pop(),j=i[0],k=i[1];8>j+1&&8>k+1&&d[j+1][k+1]===!1&&c[j+1][k+1]===f&&(h.push([j+1,k+1]),g++,d[j+1][k+1]=!0),j-1>=0&&k-1>=0&&d[j-1][k-1]===!1&&c[j-1][k-1]===f&&(h.push([j-1,k-1]),g++,d[j-1][k-1]=!0),8>j+1&&k-1>=0&&d[j+1][k-1]===!1&&c[j+1][k-1]===f&&(h.push([j+1,k-1]),g++,d[j+1][k-1]=!0),j-1>=0&&8>k+1&&d[j-1][k+1]===!1&&c[j-1][k+1]===f&&(h.push([j-1,k+1]),g++,d[j-1][k+1]=!0),8>j+1&&d[j+1][k]===!1&&c[j+1][k]===f&&(h.push([j+1,k]),g++,d[j+1][k]=!0),j-1>=0&&d[j-1][k]===!1&&c[j-1][k]===f&&(h.push([j-1,k]),g++,d[j-1][k]=!0),8>k+1&&d[j][k+1]===!1&&c[j][k+1]===f&&(h.push([j,k+1]),g++,d[j][k+1]=!0),k-1>=0&&d[j][k-1]===!1&&c[j][k-1]===f&&(h.push([j,k-1]),g++,d[j][k-1]=!0)}return 12===g?!0:!1}function d(a){for(var b=-1,d=-1,e=-1,f=-1,g=0;8>g;g++)for(var h=0;8>h&&!(b>=0&&d>=0&&e>=0&&f>=0);h++)"W"===a[g][h]?(b=g,d=h):"R"===a[g][h]&&(e=g,f=h);return c(b,d,a)?"W":c(e,f,a)?"R":""}function e(a,b,c){return 0==c?[a,0]:2==c?[0,b]:1==c?a>=b?[a-b,0]:[0,b-a]:-1==c?a+b>=7?[7,a+b-7]:[a+b,0]:void 0}function f(a,b){var c,d,f,g,k,l=[],m=0===b?"W":"R";for(c=0;8>c;c++)for(d=0;8>d;d++)a[c][d]===m&&(f=e(c,d,1),g=i(a,f[0],f[1],1),j(a,c,d,c+g,d+g,b)&&(k=h(a,c,d,c+g,d+g,b),l.push(k)),j(a,c,d,c-g,d-g,b)&&(k=h(a,c,d,c-g,d-g,b),l.push(k)),f=e(c,d,-1),g=i(a,f[0],f[1],-1),j(a,c,d,c+g,d-g,b)&&(k=h(a,c,d,c+g,d-g,b),l.push(k)),j(a,c,d,c-g,d+g,b)&&(k=h(a,c,d,c-g,d+g,b),l.push(k)),f=e(c,d,0),g=i(a,f[0],f[1],0),j(a,c,d,c,d-g,b)&&(k=h(a,c,d,c,d-g,b),l.push(k)),j(a,c,d,c,d+g,b)&&(k=h(a,c,d,c,d+g,b),l.push(k)),f=e(c,d,2),g=i(a,f[0],f[1],2),j(a,c,d,c-g,d,b)&&(k=h(a,c,d,c-g,d,b),l.push(k)),j(a,c,d,c+g,d,b)&&(k=h(a,c,d,c+g,d,b),l.push(k)));var n=l[Math.floor(Math.random()*l.length)];return n}function g(a,b,c,d){var f=[],g=e(b,c,1),h=i(a,g[0],g[1],1);return j(a,b,c,b+h,c+h,d)&&f.push([b+h,c+h]),j(a,b,c,b-h,c-h,d)&&f.push([b-h,c-h]),g=e(b,c,-1),h=i(a,g[0],g[1],-1),j(a,b,c,b-h,c+h,d)&&f.push([b-h,c+h]),j(a,b,c,b+h,c-h,d)&&f.push([b+h,c-h]),g=e(b,c,0),h=i(a,g[0],g[1],0),j(a,b,c,b,c+h,d)&&f.push([b,c+h]),j(a,b,c,b,c-h,d)&&f.push([b,c-h]),g=e(b,c,2),h=i(a,g[0],g[1],2),j(a,b,c,b+h,c,d)&&f.push([b+h,c]),j(a,b,c,b-h,c,d)&&f.push([b-h,c]),f}function h(a,c,e,f,g,h){var i=b(a);i[f][g]=0===h?"W":"R",i[c][e]="";var j,k=d(i);return j=""!==k?{endMatch:{endMatchScores:"W"===k?[1,0]:[0,1]}}:{setTurn:{turnIndex:1-h}},[j,{set:{key:"board",value:i}},{set:{key:"delta",value:{brow:c,bcol:e,arow:f,acol:g}}}]}function i(a,b,c,d){var e=0;if(0===d)for(var f=0;8>f;f++)""!==a[b][c+f]&&e++;else if(2===d)for(var f=0;8>f;f++)""!==a[b+f][c]&&e++;else if(1===d)for(;8!==b&&8!==c;)""!==a[b][c]&&e++,b++,c++;else for(;-1!==b&&8!==c;)""!==a[b][c]&&e++,b--,c++;return e}function j(a,b,c,d,e,f){if(d>7||0>d||e>7||0>e)return!1;if(""!==a[d][e])return!1;var g=0===f?"R":"W";if(a[b][c]===g)return!1;if(Math.abs(b-d)!==Math.abs(c-e)&&b!==d&&c!==e)return!1;var h,j,k,l;b-d===0?(h=Math.abs(c-e),j=b,k=0,l=0):c-e===0?(h=Math.abs(b-d),j=0,k=c,l=2):(h=Math.abs(b-d),l=(b-d)/(c-e),l>0?b>=c?(j=b-c,k=0):(j=0,k=c-b):b+c>=7?(j=7,k=b+c-7):(j=b+c,k=0));var m=i(a,j,k,l);if(h!==m)return!1;for(var n=(d-b)/h,o=(e-c)/h,p=b,q=c;p!==d||q!==e;)if(p+=n,q+=o,a[p][q]===g)return!1;return!0}function k(a,b,c){for(var d=[],e=b,f=a,g=0;g<c.length;g++){var i=c[g];void 0==e.board&&(e.board=[["","R","R","R","R","R","R",""],["W","","","","","","","W"],["W","","","","","","","W"],["W","","","","","","","W"],["W","","","","","","","W"],["W","","","","","","","W"],["W","","","","","","","W"],["","R","R","R","R","R","R",""]]);var j=h(e.board,i.brow,i.bcol,i.arow,i.acol,f),k={board:j[1].set.value,delta:j[2].set.value};d.push({stateBeforeMove:e,stateAfterMove:k,turnIndexBeforeMove:f,turnIndexAfterMove:1-f,move:j,comment:{en:i.comment}}),e=k,f=1-f}return d}function l(){return[["","R","R","R","R","R","R",""],["W","","","","","","","W"],["W","","","","","","","W"],["W","","","","","","","W"],["W","","","","","","","W"],["W","","","","","","","W"],["W","","","","","","","W"],["","R","R","R","R","R","R",""]]}function m(){return[k(1,{board:[["W","","","","R","","",""],["W","W","W","","","","",""],["W","R","W","R","","","",""],["W","","R","","","","","R"],["W","","","R","","W","",""],["W","","W","","","","",""],["","","W","R","","","",""],["","R","R","R","R","R","",""]],delta:{brow:0,bcol:0,arow:0,acol:0}},[{brow:0,bcol:4,arow:2,acol:4,comment:"find the position for red where he could win the game"},{brow:4,bcol:5,arow:2,acol:5,comment:"white moves (4,5) to (2,5)"},{brow:7,bcol:5,arow:5,acol:3,comment:"red moves (7,5) to (5,3)"},{brow:2,bcol:5,arow:1,acol:4,comment:"white moves (2,5) to (1,4)"},{brow:3,bcol:7,arow:3,acol:4,comment:"red moves (3,7) to (3,4), red wins"}])]}function n(){return k(0,{},[{brow:1,bcol:0,arow:1,acol:2,comment:"The classic opening: white moves (1,0) to (1,2)"},{brow:0,bcol:3,arow:2,acol:3,comment:"red moves (0,2) to (2,3)"},{brow:1,bcol:2,arow:4,acol:2,comment:"white moves (1,2) to (4,2)"},{brow:0,bcol:1,arow:3,acol:4,comment:"red moves (0,1) to (3,4)"},{brow:6,bcol:0,arow:6,acol:2,comment:"white moves (6,0) to (6,2)"},{brow:0,bcol:5,arow:3,acol:2,comment:"red moves (0,5) to (3,2)"},{brow:5,bcol:0,arow:5,acol:2,comment:"white moves (5,0) to (5,2)"},{brow:0,bcol:2,arow:2,acol:4,comment:"red moves (0,2) to (2,4)"},{brow:6,bcol:7,arow:6,acol:5,comment:"white moves (6,7) to (6,5)"},{brow:0,bcol:4,arow:2,acol:6,comment:"red moves (0,4) to (2,6)"},{brow:5,bcol:7,arow:0,acol:7,comment:"white moves (5,7) to (0,7)"},{brow:0,bcol:6,arow:3,acol:6,comment:"red moves (0,6) to (3,6)"},{brow:0,bcol:7,arow:0,acol:6,comment:"white moves (0,7) to (0,6)"},{brow:3,bcol:6,arow:6,acol:3,comment:"red moves (3,6) to (6,3)"},{brow:6,bcol:5,arow:4,acol:5,comment:"white moves (6,5) to (4,5)"},{brow:2,bcol:6,arow:2,acol:1,comment:"red moves (2,6) to (2,1)"},{brow:4,bcol:7,arow:3,acol:6,comment:"white moves (4,7) to (3,6)"},{brow:7,bcol:6,arow:4,acol:3,comment:"red moves (7,6) to (4,3)"},{brow:2,bcol:0,arow:5,acol:0,comment:"white moves (2,0) to (5,0)"},{brow:7,bcol:5,arow:5,acol:3,comment:"red moves (7,5) to (5,3), red wins!"}])}function o(b){var c=b.move,d=b.turnIndexBeforeMove,e=b.stateBeforeMove;try{var f=c[2].set.value.brow,g=c[2].set.value.bcol,i=c[2].set.value.arow,k=c[2].set.value.acol,l=e.board;if(void 0===l&&(l=[["","R","R","R","R","R","R",""],["W","","","","","","","W"],["W","","","","","","","W"],["W","","","","","","","W"],["W","","","","","","","W"],["W","","","","","","","W"],["W","","","","","","","W"],["","R","R","R","R","R","R",""]]),!j(l,f,g,i,k,d))return!1;var m=h(l,f,g,i,k,d);if(!a(c,m))return!1}catch(n){return!1}return!0}this.getPossibleMoves=g,this.createComputerMove=f,this.createMove=h,this.getInitialBoard=l,this.isMoveOk=o,this.getExampleGame=n,this.getRiddles=m});
//# sourceMappingURL=everything.min.js.map